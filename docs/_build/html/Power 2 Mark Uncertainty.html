<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Information Entropy &mdash; pynoddy  documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="pynoddy  documentation" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pynoddy  documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pynoddy.history</span>
<span class="kn">import</span> <span class="nn">pynoddy.output</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># os.chdir(r&quot;/Users/Florian/Documents/10_Geomodels/Noddy/GBasin/GBasin&quot;)</span>
<span class="c"># os.chdir(r&quot;/Users/flow/Documents/02_work/10_Geomodels/06_Noddy/GBasin&quot;)</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s">r&#39;/Users/flow/git/pynoddy/examples/&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">pynoddy</span><span class="o">.</span><span class="n">__file__</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>/Users/flow/git/pynoddy/pynoddy/__init__.pyc
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">reload</span><span class="p">(</span><span class="n">pynoddy</span><span class="o">.</span><span class="n">history</span><span class="p">)</span>
<span class="nb">reload</span><span class="p">(</span><span class="n">pynoddy</span><span class="o">.</span><span class="n">events</span><span class="p">)</span>
<span class="n">his</span> <span class="o">=</span> <span class="s">&quot;GBasi123.his&quot;</span>
<span class="n">PH</span> <span class="o">=</span> <span class="n">pynoddy</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">NoddyHistory</span><span class="p">(</span><span class="n">his</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="s">&#39;GBasin_out&#39;</span>
<span class="n">pynoddy</span><span class="o">.</span><span class="n">compute_model</span><span class="p">(</span><span class="n">his</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="k">print</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">PO</span> <span class="o">=</span> <span class="n">pynoddy</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">NoddyOutput</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre> STRATIGRAPHY
 UNCONFORMITY
 UNCONFORMITY
 UNCONFORMITY
 FOLD
 FAULT
 FAULT
 FAULT
 UNCONFORMITY
/Users/flow/git/pynoddy/examples
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">ls</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>GBasi123.his                            GBasin_strat_combined_high.vtr.zip      simple_two_faults_slice.his
GBasin_out.g00                          GBasin_strat_num_high.vtr               slightly_complicated.his
GBasin_out.g01                          GBasin_uncertainty.zip                  strat_combined_high.pkl
GBasin_out.g02                          README.md                               strat_differs_high.pkl
GBasin_out.g12                          gipps_uncertainty.py                    strat_num_high.pkl
GBasin_simplified.his                   gipps_uncertainty.pyc                   strike_slip.his
GBasin_strat_bins_high.vtr              noddyBatchProgress.txt                  [34mtmp[m[m/
GBasin_strat_combined_high.vtr          simple_two_faults.his                   two_faults_fold_unconformity_slice.his
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">PH</span><span class="o">.</span><span class="n">events</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">properties</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&#39;Amplitude&#39;</span><span class="p">:</span> <span class="mf">350.0</span><span class="p">,</span>
 <span class="s">&#39;Cylindricity&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s">&#39;Dip&#39;</span><span class="p">:</span> <span class="mf">90.0</span><span class="p">,</span>
 <span class="s">&#39;Dip Direction&#39;</span><span class="p">:</span> <span class="mf">90.0</span><span class="p">,</span>
 <span class="s">&#39;Pitch&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s">&#39;Single Fold&#39;</span><span class="p">:</span> <span class="s">&#39;FALSE&#39;</span><span class="p">,</span>
 <span class="s">&#39;Type&#39;</span><span class="p">:</span> <span class="s">&#39;Sine&#39;</span><span class="p">,</span>
 <span class="s">&#39;Wavelength&#39;</span><span class="p">:</span> <span class="mf">4000.0</span><span class="p">,</span>
 <span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s">&#39;Z&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">gipps_uncertainty</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">reload</span><span class="p">(</span><span class="n">gipps_uncertainty</span><span class="p">)</span>
<span class="n">GU</span> <span class="o">=</span> <span class="n">gipps_uncertainty</span><span class="o">.</span><span class="n">GUncert</span><span class="p">(</span><span class="n">PH</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Sampling step 0
Sampling step 100
Sampling step 200
Sampling step 300
Sampling step 400
Sampling step 500
Sampling step 600
Sampling step 700
Sampling step 800
Sampling step 900
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">GU</span><span class="o">.</span><span class="n">load_all_models</span><span class="p">()</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">GU</span><span class="o">.</span><span class="n">all_blocks</span><span class="o">.</span><span class="n">nbytes</span> <span class="o">/</span> <span class="mf">1E6</span>
<span class="c"># pickle.dump(GU.all_blocks, open(&quot;all_blocks.pkl&quot;, &quot;w&quot;))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">4662.4</span>
</pre></div>
</div>
<div class="section" id="information-entropy">
<h1>Information Entropy<a class="headerlink" href="#information-entropy" title="Permalink to this headline">Â¶</a></h1>
<p>As a first step, let&#8217;s have a look at probabilities and then calculate
information entropy for the entire block model!</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">GU</span><span class="o">.</span><span class="n">calculate_entropy</span><span class="p">()</span>
</pre></div>
</div>
<p>Save results and create VTK file for visualisations</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">GU</span><span class="o">.</span><span class="n">entropy</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;GB_entropy_high.pkl&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">))</span>
<span class="n">GU</span><span class="o">.</span><span class="n">export_to_vtk</span><span class="p">(</span><span class="n">GU</span><span class="o">.</span><span class="n">entropy</span><span class="p">,</span> <span class="s">&quot;entropy_high&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="stratigraphic-variability">
<h1>Stratigraphic Variability<a class="headerlink" href="#stratigraphic-variability" title="Permalink to this headline">Â¶</a></h1>
<p>The modes can simply be calculated using the scipy stats mode method:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">modes</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">GU</span><span class="o">.</span><span class="n">all_blocks</span><span class="p">)</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:,:]</span>
<span class="n">strat_var_1</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:,:]</span>
</pre></div>
</div>
<p>Actually, the correct way is to determine the number of unique values
for stratigraphic variability! So: determine the number of unique
elements (i.e. possible outputs) in each cell and combine with
probability of mode, with bins calculated above:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">s</span> <span class="o">=</span> <span class="n">bins</span><span class="o">.</span><span class="n">shape</span>
<span class="n">strat_var_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">((</span><span class="n">s</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="n">strat_var_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">GU</span><span class="o">.</span><span class="n">all_blocks</span><span class="p">[:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]))</span>
</pre></div>
</div>
<p>Thankfully, the second return value from the mode function is actually
the bin count of the modal value, so exactly what we need for the second
part of the stratigraphic variability function:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">strat_var_2</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">bins</span> <span class="o">/</span> <span class="n">GU</span><span class="o">.</span><span class="n">n</span>
<span class="n">strat_combined</span> <span class="o">=</span> <span class="n">strat_var_new</span> <span class="o">+</span> <span class="n">strat_var_2</span>
</pre></div>
</div>
<p>Save results and create VTK visualisations:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">strat_var_1</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;strat_num_high.pkl&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">))</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">strat_var_2</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;strat_differs_high.pkl&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">))</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">strat_combined</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;strat_combined_high.pkl&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">GU</span><span class="o">.</span><span class="n">export_to_vtk</span><span class="p">(</span><span class="n">strat_var_new</span><span class="p">,</span> <span class="s">&quot;strat_num_high&quot;</span><span class="p">)</span>
<span class="n">GU</span><span class="o">.</span><span class="n">export_to_vtk</span><span class="p">(</span><span class="n">strat_var_2</span><span class="p">,</span> <span class="s">&quot;strat_bins_high&quot;</span><span class="p">)</span>
<span class="n">GU</span><span class="o">.</span><span class="n">export_to_vtk</span><span class="p">(</span><span class="n">strat_combined</span><span class="p">,</span> <span class="s">&quot;strat_combined_high&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Extract slice for information theory analysis</span>
<span class="n">GU_slice</span> <span class="o">=</span> <span class="n">GU</span><span class="o">.</span><span class="n">all_blocks</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,:,:]</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">GU_slice</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;Gippsland_x_slice.pkl&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">))</span>
<span class="n">GU_y_slice</span> <span class="o">=</span> <span class="n">GU</span><span class="o">.</span><span class="n">all_blocks</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">GU_y_slice</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;Gippsland_y_slice.pkl&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">pwd</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="s">u&#39;/Users/flow/git/pynoddy/examples&#39;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">a</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;----&quot;</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>[ 1  3  1  2  3  5  1  2  5 12  3]
[ 1  1  1  2  2  3  3  3  5  5 12]
[ 0  2  6  3  7  1  4 10  5  8  9]
----
[ 1  2  3  5 12]
4
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">a_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span> <span class="n">a_sort</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>[[0 1 1 2]
 [0 1 1 2]
 [0 1 2 2]
 [0 1 1 2]
 [0 0 2 2]
 [0 0 2 2]
 [0 0 0 1]
 [0 0 1 1]]
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">a_sort</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">a_sort</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">id_a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">300.</span> <span class="k">for</span> <span class="n">id_a</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">b</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.31666667</span><span class="p">,</span>  <span class="mf">0.30666667</span><span class="p">,</span>  <span class="mf">0.32666667</span><span class="p">,</span>  <span class="mf">0.29333333</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span> <span class="mf">0.35666667</span><span class="p">,</span>  <span class="mf">0.32333333</span><span class="p">,</span>  <span class="mf">0.35333333</span><span class="p">,</span>  <span class="mf">0.32666667</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span> <span class="mf">0.32666667</span><span class="p">,</span>  <span class="mf">0.37</span>      <span class="p">,</span>  <span class="mf">0.32</span>      <span class="p">,</span>  <span class="mf">0.38</span>      <span class="p">])]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">b</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.25</span> <span class="p">,</span>  <span class="mf">0.25</span> <span class="p">,</span>  <span class="mf">0.125</span><span class="p">,</span>  <span class="mf">0.375</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span> <span class="mf">0.625</span><span class="p">,</span>  <span class="mf">0.5</span>  <span class="p">,</span>  <span class="mf">0.5</span>  <span class="p">,</span>  <span class="mf">0.375</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span> <span class="mf">0.125</span><span class="p">,</span>  <span class="mf">0.25</span> <span class="p">,</span>  <span class="mf">0.375</span><span class="p">,</span>  <span class="mf">0.25</span> <span class="p">])]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>  File &quot;&lt;ipython-input-165-2ed524e762bc&gt;&quot;, line 1
    np.unique(a, [:,:,:])
                  ^
SyntaxError: invalid syntax
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="mi">2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">**</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">6.375</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">own_sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">x</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">s</span>
    <span class="k">return</span> <span class="n">s</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">own_sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">1.5</span>
<span class="mf">1.41666666667</span>
<span class="mf">1.41421568627</span>
<span class="mf">1.41421356237</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">1.4142135623746899</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre>pynoddy?
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre>cd ~/git/pynoddy/examples/
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>/Users/flow/git/pynoddy/examples
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">NH</span> <span class="o">=</span> <span class="n">pynoddy</span><span class="o">.</span><span class="n">NoddyHistory</span><span class="p">(</span><span class="s">&quot;GBasi123.his&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">STRATIGRAPHY</span>
<span class="n">UNCONFORMITY</span>
<span class="n">UNCONFORMITY</span>
<span class="n">UNCONFORMITY</span>
<span class="n">FOLD</span>
<span class="n">FAULT</span>
<span class="n">FAULT</span>
<span class="n">FAULT</span>
<span class="n">UNCONFORMITY</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre>run gipps_uncertainty
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre> STRATIGRAPHY
 UNCONFORMITY
 UNCONFORMITY
 UNCONFORMITY
 FOLD
 FAULT
 FAULT
 FAULT
 UNCONFORMITY
Sampling step 0
Sampling step 100
Sampling step 200
Sampling step 300
Sampling step 400
Sampling step 500
Sampling step 600
Sampling step 700
Sampling step 800
Sampling step 900
9
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">NH</span><span class="o">.</span><span class="n">events</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">NH</span><span class="o">.</span><span class="n">events</span><span class="p">[</span><span class="n">event</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>&lt;pynoddy.events.Stratigraphy instance at 0x1073de3b0&gt;
&lt;pynoddy.events.Unconformity instance at 0x1073de518&gt;
&lt;pynoddy.events.Unconformity instance at 0x1073de4d0&gt;
&lt;pynoddy.events.Unconformity instance at 0x1073de368&gt;
&lt;pynoddy.events.Fold instance at 0x1073de758&gt;
&lt;pynoddy.events.Fault instance at 0x1073de950&gt;
&lt;pynoddy.events.Fault instance at 0x1073de998&gt;
&lt;pynoddy.events.Fault instance at 0x1073de3f8&gt;
&lt;pynoddy.events.Unconformity instance at 0x1073de908&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">NH</span><span class="o">.</span><span class="n">events</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">event_type</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="s">&#39;UNCONFORMITY&#39;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">type</span><span class="p">(</span><span class="n">NH</span><span class="o">.</span><span class="n">events</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">dict</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">NH</span><span class="o">.</span><span class="n">events</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>{1: &lt;pynoddy.events.Stratigraphy instance at 0x10761c710&gt;,
 2: &lt;pynoddy.events.Unconformity instance at 0x10761c758&gt;,
 3: &lt;pynoddy.events.Unconformity instance at 0x10761c7a0&gt;,
 4: &lt;pynoddy.events.Unconformity instance at 0x10761c7e8&gt;,
 5: &lt;pynoddy.events.Fold instance at 0x10761c830&gt;,
 6: &lt;pynoddy.events.Fault instance at 0x10761c908&gt;,
 7: &lt;pynoddy.events.Fault instance at 0x10761c950&gt;,
 8: &lt;pynoddy.events.Fault instance at 0x10761c878&gt;,
 9: &lt;pynoddy.events.Unconformity instance at 0x10761c8c0&gt;}
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mi">1</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>[3 2 1]
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Information Entropy</a></li>
<li><a class="reference internal" href="#stratigraphic-variability">Stratigraphic Variability</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Power 2 Mark Uncertainty.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pynoddy  documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Florian Wellmann.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>