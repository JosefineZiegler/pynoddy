<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Sensitivity Analysis Gippsland Basin Model &mdash; pynoddy  documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="pynoddy  documentation" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pynoddy  documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sensitivity-analysis-gippsland-basin-model">
<h1>Sensitivity Analysis Gippsland Basin Model<a class="headerlink" href="#sensitivity-analysis-gippsland-basin-model" title="Permalink to this headline">¶</a></h1>
<p>The kinematic model of the Gippsland Basin was constructed on the basis
of data from drillhole observations, interpreted geophysical data
(seismic sections and potential-field data) and knowledge of the
geological history.</p>
<p>As drillhole observations represent the only direct observation of the
actual geological subsurface structure, it is interesting to evaluate
how sensitive the match of the model at the position of these
observations is with respect to uncertainties about the exact geological
history.</p>
<p>We can also frame the same question in a slightly different context: how
well can we determine events of geological history on the basis of
structural information from the drillholes - in the range of the
(obviously approximate) assumptions about representing the history as a
series of kinematic events (as we do with Noddy).</p>
<p>In order to answer this question, we now use the constructed model of
the Gippsland Basin and test the sensitivity of modelled geology at
observation positions (the drillholes) with respect to several main
parameters that define the geological history as parameterised events.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="n">css_file</span> <span class="o">=</span> <span class="s">&#39;pynoddy.css&#39;</span>
<span class="n">HTML</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">css_file</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<link href='http://fonts.googleapis.com/css?family=Alegreya+Sans:100,300,400,500,700,800,900,100italic,300italic,400italic,500italic,700italic,800italic,900italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Arvo:400,700,400italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Mono' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Shadows+Into+Light' rel='stylesheet' type='text/css'>
<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Tangerine">
<link href='http://fonts.googleapis.com/css?family=Philosopher:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Libre+Baskerville:400,400italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lora:400,400italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Karla:400,400italic' rel='stylesheet' type='text/css'>

<style>

@font-face {
    font-family: "Computer Modern";
    src: url('http://mirrors.ctan.org/fonts/cm-unicode/fonts/otf/cmunss.otf');
}

#notebook_panel { /* main background */
    background: #888;
    color: #f6f6f6;
}

div.cell { /* set cell width to about 80 chars */
    width: 800px;
}

div #notebook { /* centre the content */
    background: #fff; /* white background for content */
    width: 1000px;
    margin: auto;
    padding-left: 1em;
}

#notebook li { /* More space between bullet points */
margin-top:0.8em;
}

/* draw border around running cells */
div.cell.border-box-sizing.code_cell.running {
    border: 3px solid #111;
}

/* Put a solid color box around each cell and its output, visually linking them together */
div.cell.code_cell {
    background: #ddd;  /* rgba(230,230,230,1.0);  */
    border-radius: 10px; /* rounded borders */
    width: 900px;
    padding: 1em;
    margin-top: 1em;
}

div.text_cell_render{
    font-family: 'Arvo' sans-serif;
    line-height: 130%;
    font-size: 115%;
    width:700px;
    margin-left:auto;
    margin-right:auto;
}


/* Formatting for header cells */
.text_cell_render h1 {
    font-family: 'Alegreya Sans', sans-serif;
    /* font-family: 'Tangerine', serif; */
    /* font-family: 'Libre Baskerville', serif; */
    /* font-family: 'Karla', sans-serif;
    /* font-family: 'Lora', serif; */
    font-size: 50px;
    text-align: center;
    /* font-style: italic; */
    font-weight: 400;
    /* font-size: 40pt; */
    /* text-shadow: 4px 4px 4px #aaa; */
    line-height: 120%;
    color: rgb(12,85,97);
    margin-bottom: .5em;
    margin-top: 0.1em;
    display: block;
}
.text_cell_render h2 {
    /* font-family: 'Arial', serif; */
    /* font-family: 'Lora', serif; */
    font-family: 'Alegreya Sans', sans-serif;
    font-weight: 700;
    font-size: 24pt;
    line-height: 100%;
    /* color: rgb(171,165,131); */
    color: rgb(12,85,97);
    margin-bottom: 0.1em;
    margin-top: 0.1em;
    display: block;
}

.text_cell_render h3 {
    font-family: 'Arial', serif;
    margin-top:12px;
    margin-bottom: 3px;
    font-style: italic;
    color: rgb(95,92,72);
}

.text_cell_render h4 {
    font-family: 'Arial', serif;
}

.text_cell_render h5 {
    font-family: 'Alegreya Sans', sans-serif;
    font-weight: 300;
    font-size: 16pt;
    color: grey;
    font-style: italic;
    margin-bottom: .1em;
    margin-top: 0.1em;
    display: block;
}

.text_cell_render h6 {
    font-family: 'PT Mono', sans-serif;
    font-weight: 300;
    font-size: 10pt;
    color: grey;
    margin-bottom: 1px;
    margin-top: 1px;
}

.CodeMirror{
        font-family: "PT Mono";
        font-size: 100%;
}

</style><div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="c"># adjust some settings for matplotlib</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="c"># print rcParams</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
<span class="c"># determine path of repository to set paths corretly below</span>
<span class="c"># os.chdir(r&#39;/Users/flow/git/pynoddy/docs/notebooks/&#39;)</span>
<span class="n">repo_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="s">&#39;../..&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pynoddy.history</span>
<span class="kn">import</span> <span class="nn">pynoddy.events</span>
</pre></div>
</div>
<div class="section" id="analysis-of-events-in-the-gippsland-basin-model">
<h2>Analysis of events in the Gippsland Basin model<a class="headerlink" href="#analysis-of-events-in-the-gippsland-basin-model" title="Permalink to this headline">¶</a></h2>
<p>We are starting with an analysis of the events in the Gippsland Basin
model - and a quick overview of the model in sections:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s">r&#39;/Users/flow/git/paper_pynoddy/notebooks&#39;</span><span class="p">)</span>
<span class="nb">reload</span><span class="p">(</span><span class="n">pynoddy</span><span class="o">.</span><span class="n">history</span><span class="p">)</span>
<span class="n">gipps</span> <span class="o">=</span> <span class="n">pynoddy</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">NoddyHistory</span><span class="p">(</span><span class="s">&quot;GBasin_Ve1_V4_b.his&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">STRATIGRAPHY</span>
<span class="n">FOLD</span>
<span class="n">UNCONFORMITY</span>
<span class="n">FAULT</span>
<span class="n">FAULT</span>
<span class="n">UNCONFORMITY</span>
<span class="n">FAULT</span>
<span class="n">FAULT</span>
<span class="n">UNCONFORMITY</span>
<span class="n">FAULT</span>
<span class="n">FAULT</span>
<span class="n">UNCONFORMITY</span>
<span class="n">TILT</span>
<span class="n">FOLD</span>
</pre></div>
</div>
<p>We first have a quick look at the model and the defined events:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">gipps</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<pre class="literal-block">
<strong>********************************************************</strong>
                    Model Information
<strong>********************************************************</strong>


This model consists of 14 events:
    (1) - STRATIGRAPHY
    (2) - FOLD
    (3) - UNCONFORMITY
    (4) - FAULT
    (5) - FAULT
    (6) - UNCONFORMITY
    (7) - FAULT
    (8) - FAULT
    (9) - UNCONFORMITY
    (10) - FAULT
    (11) - FAULT
    (12) - UNCONFORMITY
    (13) - TILT
    (14) - FOLD
The model extent is:
    x - 26630.0 m
    y - 19291.0 m
    z - 1500.0 m
Number of cells in each direction:
    nx = 532
    ny = 385
    nz = 30
The model origin is located at:
    (0.0, 0.0, 1500.0)
The cubesize for model export is:
    50 m


<strong>********************************************************</strong>
                    Meta Data
<strong>********************************************************</strong>


The filename of the model is:
     GBasin_Ve1_V4.his
It was last saved (if origin was a history file!) at:
     12/11/2014 11:33:12
</pre>
<p>And for a quick overview about the model and what it actually looks
like:</p>
<p><strong>TO DO: Fix colorbar</strong></p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">os</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;/Users/flow/git/pynoddy&#39;</span><span class="p">,</span> <span class="s">&#39;/Users/flow/git/prettyplotlib&#39;</span><span class="p">,</span> <span class="s">&#39;/Users/flow/git/github/pygeomod&#39;</span><span class="p">,</span> <span class="s">&#39;/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip&#39;</span><span class="p">,</span> <span class="s">&#39;/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7&#39;</span><span class="p">,</span> <span class="s">&#39;/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin&#39;</span><span class="p">,</span> <span class="s">&#39;/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac&#39;</span><span class="p">,</span> <span class="s">&#39;/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages&#39;</span><span class="p">,</span> <span class="s">&#39;/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk&#39;</span><span class="p">,</span> <span class="s">&#39;/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old&#39;</span><span class="p">,</span> <span class="s">&#39;/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/readline&#39;</span><span class="p">,</span> <span class="s">&#39;/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload&#39;</span><span class="p">,</span> <span class="s">&#39;/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages&#39;</span><span class="p">,</span> <span class="s">&#39;/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/PIL&#39;</span><span class="p">,</span> <span class="s">&#39;/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/gtk-2.0&#39;</span><span class="p">,</span> <span class="s">&#39;/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/wx-2.8-gtk2-unicode&#39;</span><span class="p">,</span> <span class="s">&#39;/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/IPython/extensions&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">os</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">r&quot;/Users/flow/bin&quot;</span><span class="p">)</span>
<span class="c"># Compute the model</span>
<span class="nb">reload</span><span class="p">(</span><span class="n">pynoddy</span><span class="p">)</span>
<span class="n">his</span> <span class="o">=</span> <span class="s">&#39;GBasin_V4_new.his&#39;</span>
<span class="n">gipps</span><span class="o">.</span><span class="n">write_history</span><span class="p">(</span><span class="n">his</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="s">&#39;GBasin_V4_out&#39;</span>
<span class="n">pynoddy</span><span class="o">.</span><span class="n">compute_model</span><span class="p">(</span><span class="n">his</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">reload</span><span class="p">(</span><span class="n">pynoddy</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
<span class="n">gipps_out</span> <span class="o">=</span> <span class="n">pynoddy</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">NoddyOutput</span><span class="p">(</span><span class="s">&quot;tmp_out&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">gipps</span><span class="o">.</span><span class="n">determine_model_stratigraphy</span><span class="p">()</span>
<span class="c"># create section plots in axes diretions:</span>
<span class="n">gipps_out</span><span class="o">.</span><span class="n">plot_section</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">ve</span> <span class="o">=</span> <span class="mf">5.</span><span class="p">,</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="s">&#39;YlOrRd&#39;</span><span class="p">,</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
                <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
<span class="c">#                layer_labels = gipps.model_stratigraphy</span>
                <span class="p">)</span>
<span class="n">gipps_out</span><span class="o">.</span><span class="n">plot_section</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">ve</span> <span class="o">=</span> <span class="mf">5.</span><span class="p">,</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="s">&#39;YlOrRd&#39;</span><span class="p">,</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
                 <span class="n">colorbar_orientation</span> <span class="o">=</span> <span class="s">&#39;horizontal&#39;</span><span class="p">,</span>
 <span class="c">#                layer_labels = gipps.model_stratigraphy</span>
                 <span class="p">)</span>
</pre></div>
</div>
<img alt="_images/SA-Gippsland_11_0.png" src="_images/SA-Gippsland_11_0.png" />
<img alt="_images/SA-Gippsland_11_1.png" src="_images/SA-Gippsland_11_1.png" />
</div>
<div class="section" id="extract-1-d-drillhole-information">
<h2>Extract 1-D drillhole information<a class="headerlink" href="#extract-1-d-drillhole-information" title="Permalink to this headline">¶</a></h2>
<p>We will now define drillholes at defined positions within the model and
export high-resolution 1-D vertical profiles for those drillholes and
their appropriate depth.</p>
<p>We define the drillhole &#8220;coller&#8221; data as dictionaries for more clarity
below:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">reload</span><span class="p">(</span><span class="n">pynoddy</span><span class="o">.</span><span class="n">history</span><span class="p">)</span>
<span class="n">gipps</span> <span class="o">=</span> <span class="n">pynoddy</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">NoddyHistory</span><span class="p">(</span><span class="s">&quot;GBasin_Ve1_V4_b.his&quot;</span><span class="p">)</span>
<span class="n">gipps</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="mi">440</span> <span class="o">*</span> <span class="mi">50</span>
</pre></div>
</div>
<pre class="literal-block">
 STRATIGRAPHY
 FOLD
 UNCONFORMITY
 FAULT
 FAULT
 UNCONFORMITY
 FAULT
 FAULT
 UNCONFORMITY
 FAULT
 FAULT
 UNCONFORMITY
 TILT
 FOLD
<strong>********************************************************</strong>
                    Model Information
<strong>********************************************************</strong>


This model consists of 14 events:
    (1) - STRATIGRAPHY
    (2) - FOLD
    (3) - UNCONFORMITY
    (4) - FAULT
    (5) - FAULT
    (6) - UNCONFORMITY
    (7) - FAULT
    (8) - FAULT
    (9) - UNCONFORMITY
    (10) - FAULT
    (11) - FAULT
    (12) - UNCONFORMITY
    (13) - TILT
    (14) - FOLD
The model extent is:
    x - 26630.0 m
    y - 19291.0 m
    z - 1500.0 m
Number of cells in each direction:
    nx = 532
    ny = 385
    nz = 30
The model origin is located at:
    (0.0, 0.0, 1500.0)
The cubesize for model export is:
    50 m


<strong>********************************************************</strong>
                    Meta Data
<strong>********************************************************</strong>


The filename of the model is:
     GBasin_Ve1_V4.his
It was last saved (if origin was a history file!) at:
     12/11/2014 11:33:12
</pre>
<div class="highlight-python"><div class="highlight"><pre><span class="mi">22000</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Create dictionaries for wells:</span>
<span class="n">drill_1</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span> <span class="p">:</span> <span class="mf">22000.</span><span class="p">,</span> <span class="s">&#39;y&#39;</span> <span class="p">:</span> <span class="mf">9600.</span><span class="p">,</span> <span class="s">&#39;z_max&#39;</span> <span class="p">:</span> <span class="mf">1000.</span><span class="p">}</span>
<span class="n">drill_2</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span> <span class="p">:</span> <span class="mf">20000.</span><span class="p">,</span> <span class="s">&#39;y&#39;</span> <span class="p">:</span> <span class="mf">5000.</span><span class="p">,</span> <span class="s">&#39;z_min&#39;</span> <span class="p">:</span> <span class="mf">500.</span><span class="p">}</span>
<span class="n">drill_3</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span> <span class="p">:</span> <span class="mf">5000.</span><span class="p">,</span> <span class="s">&#39;y&#39;</span> <span class="p">:</span> <span class="mf">15000.</span><span class="p">,</span> <span class="s">&#39;z_min&#39;</span> <span class="p">:</span> <span class="mf">750.</span><span class="p">}</span>
</pre></div>
</div>
<p>So, let&#8217;s have a look at the modelled geology at one of these drillholes
for comparison:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># %%timeit # uncomment this command to time execution of command</span>
<span class="n">drill_1_data</span> <span class="o">=</span> <span class="n">gipps</span><span class="o">.</span><span class="n">get_drillhole_data</span><span class="p">(</span><span class="n">drill_1</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">],</span> <span class="n">drill_1</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">],</span> <span class="n">z_max</span> <span class="o">=</span> <span class="n">drill_1</span><span class="p">[</span><span class="s">&#39;z_max&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plot</span><span class="p">(</span><span class="n">drill_1_data</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>[&lt;matplotlib.lines.Line2D at 0x114a94a10&gt;]
</pre></div>
</div>
<img alt="_images/SA-Gippsland_17_1.png" src="_images/SA-Gippsland_17_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">gipps_out</span><span class="o">.</span><span class="n">plot_section</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s">&#39;center&#39;</span><span class="p">,</span> <span class="n">ve</span> <span class="o">=</span> <span class="mf">5.</span><span class="p">,</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="s">&#39;YlOrRd&#39;</span><span class="p">,</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">,</span>
                <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
               <span class="c"># colorbar_orientation = &#39;horizontal&#39;,</span>
<span class="c">#                layer_labels = gipps.model_stratigraphy</span>
                <span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">440</span><span class="p">,</span><span class="mi">440</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span> <span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">540</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">drill_1_data</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">drill_1_data</span><span class="p">)),</span> <span class="s">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">drill_1_data</span><span class="p">)),</span><span class="n">drill_1_data</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#39;gray&#39;</span><span class="p">)</span> <span class="c">#, range(le</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>&lt;matplotlib.collections.PolyCollection at 0x114b7ffd0&gt;
</pre></div>
</div>
<img alt="_images/SA-Gippsland_18_1.png" src="_images/SA-Gippsland_18_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">gipps_out</span><span class="o">.</span><span class="n">export_to_vtk</span><span class="p">()</span>
</pre></div>
</div>
<p>Comparing this profile to the position in the section:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">gipps_out</span><span class="o">.</span><span class="n">plot_section</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">ve</span> <span class="o">=</span> <span class="mf">5.</span><span class="p">,</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="s">&#39;YlOrRd&#39;</span><span class="p">,</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">,</span>
                <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
               <span class="c"># colorbar_orientation = &#39;horizontal&#39;,</span>
<span class="c">#                layer_labels = gipps.model_stratigraphy</span>
                <span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span> <span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">540</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">drill_1_data</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">drill_1_data</span><span class="p">)),</span> <span class="s">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">drill_1_data</span><span class="p">)),</span><span class="n">drill_1_data</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#39;gray&#39;</span><span class="p">)</span> <span class="c">#, range(len(drill_1_data)))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>&lt;matplotlib.collections.PolyCollection at 0x1145f7850&gt;
</pre></div>
</div>
<img alt="_images/SA-Gippsland_21_1.png" src="_images/SA-Gippsland_21_1.png" />
<p>The modelled geology of the drillhole matches the position in the
section (luckily!), but the profile has a much higher resolution - and
important aspect in order to use it for a meaningful sensitivity
analysis.</p>
</div>
<div class="section" id="defining-parameter-ranges-for-uncertain-events">
<h2>Defining parameter ranges for uncertain events<a class="headerlink" href="#defining-parameter-ranges-for-uncertain-events" title="Permalink to this headline">¶</a></h2>
<p>We now need to define the parameter ranges for the geological events in
the model. Here a list of the events again:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">gipps</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">events_only</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>This model consists of 14 events:
    (1) - STRATIGRAPHY
    (2) - FOLD
    (3) - UNCONFORMITY
    (4) - FAULT
    (5) - FAULT
    (6) - UNCONFORMITY
    (7) - FAULT
    (8) - FAULT
    (9) - UNCONFORMITY
    (10) - FAULT
    (11) - FAULT
    (12) - UNCONFORMITY
    (13) - TILT
    (14) - FOLD
</pre></div>
</div>
<p>Relevant parameters for typical events are (this is a minimum number
more parameters can be defined!):</p>
<ul class="simple">
<li>Faults: x, y, z, dip, dip direction, slip (6)</li>
<li>Tilt: x, y, z, plunge, plunge direction, rotation (6)</li>
<li>Fold: x, y, z, wavelength, amplitude (5)</li>
<li>Unconformity: x, y, z, dip, dip direction (5)</li>
</ul>
<p>In our case, we would have a total of <strong>72 parameters</strong>! We might be
able to reduce some parameters due to translational invariance:</p>
<ul class="simple">
<li>unconformities without dip: x,y position not relevant</li>
<li>faults with dip direction in one of main axes: one axis irrelevant</li>
<li>fold parallel to main axis: one axis irrelevant</li>
<li>same for tilt.</li>
</ul>
<p>Note: this assumption is, of course, only valid if we assume that the
uncertainty in, say, the dip direction of a fault is so small that the
uncertainty in the position can be neglected. In a sense of a local
sensitivity analysis, this is certainly the case - with a global
sensitivity analysis (as we aim for here), the correlated sensitivity
could be analysed - however, at the cost of adding one more parameter!</p>
<p>So, we have to evaluate the events and see if we can reduce the order of
the problem:</p>
<ul class="simple">
<li>2: Fold dip dir is 090, so invariant to y</li>
<li>3: Unconformity is flat, only one parameter (z)</li>
<li>4: Fault dip dir is 270, invariant to y</li>
<li>5: no reduction possible</li>
<li>6: Unconformity is flat, only one parameter (z)</li>
<li>7: Dip direction 180, invariant to x</li>
<li>8: no reduction possible</li>
<li>9: Unconformity is flat, only one parameter (z)</li>
<li>10: no reduction possible</li>
<li>11: dip dir 270, invariant to y</li>
<li>12: unfortunately a small dip (1 degree) - still consider as flat and
only z?</li>
<li>13: as tilt affects entire block: position of x,y,z not important?</li>
<li>14: direction 180: invariant to x.</li>
</ul>
<p>In total, we remain with: 42 parameters! Still a lot... but let&#8217;s see -
a model calculation for a 1-D export is quite fast (approx. 0.1 s), so
it could be possible.</p>
<p>We define ranges for the remaining parameters and save them to a file:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">param_file</span> <span class="o">=</span> <span class="s">&quot;params_gipps.txt&quot;</span>
<span class="n">params</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;ev2_fold_amplitude 400. 600.</span>
<span class="s">ev2_fold_wavelength 12500. 17500.</span>
<span class="s">ev2_fold_x 0 15000.</span>
<span class="s">ev2_fold_z 0 1000.</span>
<span class="s">ev3_uc_z 150. 350.</span>
<span class="s">ev4_fault_dip 60. 80.</span>
<span class="s">ev4_fault_x 22000. 24000.</span>
<span class="s">ev4_fault_z 4000. 6000.</span>
<span class="s">ev4_fault_slip 0 -200.</span>
<span class="s">ev5_fault_dip 60. 80.</span>
<span class="s">ev5_fault_dip_dir 276. 296.</span>
<span class="s">ev5_fault_x 17000. 19000.</span>
<span class="s">ev5_fault_y 0 1000.</span>
<span class="s">ev5_fault_z 4000. 6000.</span>
<span class="s">ev5_fault_slip 0 -200.</span>
<span class="s">ev6_uc_z 650. 850.</span>
<span class="s">ev7_fault_dip 60. 80.</span>
<span class="s">ev7_fault_y 12000. 14000.</span>
<span class="s">ev7_fault_z 4000. 6000.</span>
<span class="s">ev7_fault_slip 400. 600.</span>
<span class="s">ev8_fault_dip 35. 55.</span>
<span class="s">ev8_fault_dip_dir 0. 20.</span>
<span class="s">ev8_fault_x 7730. 9730.</span>
<span class="s">ev8_fault_y -1000. 1000.</span>
<span class="s">ev8_fault_z 4000. 6000.</span>
<span class="s">ev8_fault_slip 400. 600.</span>
<span class="s">ev9_uc_z 650. 850.</span>
<span class="s">ev10_fault_dip 60. 80.</span>
<span class="s">ev10_fault_dip_dir 276. 296.</span>
<span class="s">ev10_fault_x 17000. 19000.</span>
<span class="s">ev10_fault_y -1000. 1000.</span>
<span class="s">ev10_fault_z 4000. 6000.</span>
<span class="s">ev10_fault_slip 100. 300.</span>
<span class="s">ev11_fault_dip 60. 80.</span>
<span class="s">ev11_fault_x 22000. 24000.</span>
<span class="s">ev11_fault_z 4000. 6000.</span>
<span class="s">ev11_fault_slip 100. 300.</span>
<span class="s">ev12_uc_z 900. 1100.</span>
<span class="s">ev13_tilt_plunge_dir 38. 58.</span>
<span class="s">ev13_tilt_rot 350. 360.</span>
<span class="s">ev14_fold_amplitude 400. 600.</span>
<span class="s">ev14_fold_wavelength 16000. 18000.</span>
<span class="s">ev14_fold_y 0 17000.&quot;&quot;&quot;</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">param_file</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre>!wc -l params_gipps.txt
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>42 params_gipps.txt
</pre></div>
</div>
</div>
<div class="section" id="generate-samples-for-sensitivity-analysis">
<h2>Generate samples for sensitivity analysis<a class="headerlink" href="#generate-samples-for-sensitivity-analysis" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">SALib.sample</span> <span class="kn">import</span> <span class="n">saltelli</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">param_values</span> <span class="o">=</span> <span class="n">saltelli</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">param_file</span><span class="p">,</span> <span class="n">calc_second_order</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">len</span><span class="p">(</span><span class="n">param_values</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mi">880</span>
</pre></div>
</div>
</div>
<div class="section" id="running-the-models">
<h2>Running the models<a class="headerlink" href="#running-the-models" title="Permalink to this headline">¶</a></h2>
<p>We now run the models, one for each of the generated parameter sets</p>
<div class="code python highlight-python"><div class="highlight"><pre># set resolution for analysis:
res = 1 # m

# get original model distance again:
drill_1_ori = gipps.get_drillhole_data((drill_1[&#39;x&#39;],
                                    drill_1[&#39;y&#39;],
                                    z_max = drill_1[&#39;z_min&#39;])

def change_model_with_paramter_array(param):
    # create a copy of the history object
    gipps_changed = copy.deepcopy(gipps_ori)

    # define the elemtents and values of the events to change.
    # Note: the order of parameters is as in the text file created above!
    changes_fault_1 = {&#39;Dip&#39; : param[0],
                       &#39;Dip Direction&#39; : param[1],
                       &#39;Slip&#39; : param[2]}
    changes_fault_2 = {&#39;Dip&#39; : param[3],
                       &#39;Dip Direction&#39; : param[4],
                       &#39;Slip&#39; : param[5]}

    # Assign those changes to the events (note: event ids)
    param_changes = {2 : changes_fault_1,
                     3 : changes_fault_2}

    # Perform changes
    nm_changed.change_event_params(param_changes)

    # Export drillhole profiles
    # drill_changed_left = nm_changed.get_drillhole_data(2000, 3500)
    drill_changed_fault = nm_changed.get_drillhole_data(4000, 3500, resolution = res)
    # drill_changed_centre = nm_changed.get_drillhole_data(5000, 3500)

    # calculate and return distance:
    return distance(drill_ori_fault, drill_changed_fault)
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">gipps</span><span class="o">.</span><span class="n">events</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">.</span><span class="n">properties</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">pwd</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="s">u&#39;/Users/flow/git/paper_pynoddy/notebooks&#39;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">param_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">print</span> <span class="n">i</span><span class="p">,</span><span class="n">param</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>0 443.9453125
1 12983.3984375
2 7778.3203125
3 676.7578125
4 206.0546875
5 78.14453125
6 22091.796875
7 5798.828125
8 -100.1953125
9 61.38671875
10 277.69921875
11 17509.765625
12 161.1328125
13 4767.578125
14 -28.7109375
15 724.0234375
16 74.39453125
17 12689.453125
18 5982.421875
19 545.1171875
20 45.44921875
21 10.99609375
22 9630.390625
23 80.078125
24 5166.015625
25 581.4453125
26 658.0078125
27 79.58984375
28 277.19140625
29 17681.640625
30 -705.078125
31 4291.015625
32 159.1796875
33 71.85546875
34 23603.515625
35 5541.015625
36 269.7265625
37 1066.2109375
38 44.15234375
39 354.794921875
40 582.6171875
41 16509.765625
42 16319.3359375
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Sensitivity Analysis Gippsland Basin Model</a><ul>
<li><a class="reference internal" href="#analysis-of-events-in-the-gippsland-basin-model">Analysis of events in the Gippsland Basin model</a></li>
<li><a class="reference internal" href="#extract-1-d-drillhole-information">Extract 1-D drillhole information</a></li>
<li><a class="reference internal" href="#defining-parameter-ranges-for-uncertain-events">Defining parameter ranges for uncertain events</a></li>
<li><a class="reference internal" href="#generate-samples-for-sensitivity-analysis">Generate samples for sensitivity analysis</a></li>
<li><a class="reference internal" href="#running-the-models">Running the models</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/SA-Gippsland.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pynoddy  documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Florian Wellmann.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>