<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Sensitivity analysis with SALib &mdash; pynoddy  documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="pynoddy  documentation" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pynoddy  documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sensitivity-analysis-with-salib">
<h1>Sensitivity analysis with SALib<a class="headerlink" href="#sensitivity-analysis-with-salib" title="Permalink to this headline">¶</a></h1>
<p>We have got the single parts now for the sensitivity analysis. We are
now using the global sensitivity analysis methods of the Python package
SALib, available on:</p>
<p><a class="reference external" href="https://github.com/jdherman/SALib">https://github.com/jdherman/SALib</a></p>
<p>As a start, we will test the sensitivity of the model at each drillhole
position separately. As parameters, we will use the parameters of the
fault events: dip, dip direction, and slip.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="n">css_file</span> <span class="o">=</span> <span class="s">&#39;pynoddy.css&#39;</span>
<span class="n">HTML</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">css_file</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<link href='http://fonts.googleapis.com/css?family=Alegreya+Sans:100,300,400,500,700,800,900,100italic,300italic,400italic,500italic,700italic,800italic,900italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Arvo:400,700,400italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Mono' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Shadows+Into+Light' rel='stylesheet' type='text/css'>
<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Tangerine">
<link href='http://fonts.googleapis.com/css?family=Philosopher:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Libre+Baskerville:400,400italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lora:400,400italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Karla:400,400italic' rel='stylesheet' type='text/css'>

<style>

@font-face {
    font-family: "Computer Modern";
    src: url('http://mirrors.ctan.org/fonts/cm-unicode/fonts/otf/cmunss.otf');
}

#notebook_panel { /* main background */
    background: #888;
    color: #f6f6f6;
}

div.cell { /* set cell width to about 80 chars */
    width: 800px;
}

div #notebook { /* centre the content */
    background: #fff; /* white background for content */
    width: 1000px;
    margin: auto;
    padding-left: 1em;
}

#notebook li { /* More space between bullet points */
margin-top:0.8em;
}

/* draw border around running cells */
div.cell.border-box-sizing.code_cell.running {
    border: 3px solid #111;
}

/* Put a solid color box around each cell and its output, visually linking them together */
div.cell.code_cell {
    background: #ddd;  /* rgba(230,230,230,1.0);  */
    border-radius: 10px; /* rounded borders */
    width: 900px;
    padding: 1em;
    margin-top: 1em;
}

div.text_cell_render{
    font-family: 'Arvo' sans-serif;
    line-height: 130%;
    font-size: 115%;
    width:700px;
    margin-left:auto;
    margin-right:auto;
}


/* Formatting for header cells */
.text_cell_render h1 {
    font-family: 'Alegreya Sans', sans-serif;
    /* font-family: 'Tangerine', serif; */
    /* font-family: 'Libre Baskerville', serif; */
    /* font-family: 'Karla', sans-serif;
    /* font-family: 'Lora', serif; */
    font-size: 50px;
    text-align: center;
    /* font-style: italic; */
    font-weight: 400;
    /* font-size: 40pt; */
    /* text-shadow: 4px 4px 4px #aaa; */
    line-height: 120%;
    color: rgb(12,85,97);
    margin-bottom: .5em;
    margin-top: 0.1em;
    display: block;
}
.text_cell_render h2 {
    /* font-family: 'Arial', serif; */
    /* font-family: 'Lora', serif; */
    font-family: 'Alegreya Sans', sans-serif;
    font-weight: 700;
    font-size: 24pt;
    line-height: 100%;
    /* color: rgb(171,165,131); */
    color: rgb(12,85,97);
    margin-bottom: 0.1em;
    margin-top: 0.1em;
    display: block;
}

.text_cell_render h3 {
    font-family: 'Arial', serif;
    margin-top:12px;
    margin-bottom: 3px;
    font-style: italic;
    color: rgb(95,92,72);
}

.text_cell_render h4 {
    font-family: 'Arial', serif;
}

.text_cell_render h5 {
    font-family: 'Alegreya Sans', sans-serif;
    font-weight: 300;
    font-size: 16pt;
    color: grey;
    font-style: italic;
    margin-bottom: .1em;
    margin-top: 0.1em;
    display: block;
}

.text_cell_render h6 {
    font-family: 'PT Mono', sans-serif;
    font-weight: 300;
    font-size: 10pt;
    color: grey;
    margin-bottom: 1px;
    margin-top: 1px;
}

.CodeMirror{
        font-family: "PT Mono";
        font-size: 100%;
}

</style><div class="code python highlight-python"><div class="highlight"><pre>%matplotlib inline
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="c"># adjust some settings for matplotlib</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="c"># print rcParams</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
<span class="c"># determine path of repository to set paths corretly below</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s">r&#39;../../../pynoddy/docs/notebooks/&#39;</span><span class="p">)</span>
<span class="n">repo_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="s">&#39;../..&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pynoddy.history</span>
<span class="kn">import</span> <span class="nn">pynoddy.experiment</span>
<span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">})</span>
</pre></div>
</div>
<div class="section" id="model-set-up">
<h2>Model set-up<a class="headerlink" href="#model-set-up" title="Permalink to this headline">¶</a></h2>
<p>We use the two-fault model from previous examples and assign parameter
ranges with a dictionary:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">reload</span><span class="p">(</span><span class="n">pynoddy</span><span class="o">.</span><span class="n">history</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pynoddy.experiment.SensitivityAnalysis</span>
<span class="nb">reload</span><span class="p">(</span><span class="n">pynoddy</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">SensitivityAnalysis</span><span class="p">)</span>
<span class="c"># Start again with the original model</span>
<span class="n">his_filename</span> <span class="o">=</span> <span class="s">&quot;two_faults_sensi.his&quot;</span>
<span class="n">sa</span> <span class="o">=</span> <span class="n">pynoddy</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">SensitivityAnalysis</span><span class="o">.</span><span class="n">SensitivityAnalysis</span><span class="p">(</span><span class="n">history</span> <span class="o">=</span> <span class="n">his_filename</span><span class="p">)</span>

<span class="c"># Initialise list</span>
<span class="n">param_stats</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c"># Add one entry as dictionary with relevant properties:</span>

<span class="c"># for event 2:</span>
<span class="n">param_stats</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;event&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;parameter&#39;</span> <span class="p">:</span> <span class="s">&#39;Dip&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span> <span class="p">:</span> <span class="mf">55.</span><span class="p">,</span> <span class="s">&#39;max&#39;</span> <span class="p">:</span> <span class="mf">65.</span><span class="p">,</span>
                    <span class="s">&#39;type&#39;</span> <span class="p">:</span> <span class="s">&#39;normal&#39;</span><span class="p">,</span> <span class="s">&#39;stdev&#39;</span> <span class="p">:</span> <span class="mf">10.</span><span class="p">,</span> <span class="s">&#39;mean&#39;</span> <span class="p">:</span> <span class="mf">60.</span><span class="p">,</span> <span class="s">&#39;initial&#39;</span> <span class="p">:</span> <span class="mf">60.</span><span class="p">})</span>
<span class="n">param_stats</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;event&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;parameter&#39;</span> <span class="p">:</span> <span class="s">&#39;Dip Direction&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span> <span class="p">:</span> <span class="mf">85.</span><span class="p">,</span> <span class="s">&#39;max&#39;</span> <span class="p">:</span> <span class="mf">95.</span><span class="p">,</span>
                    <span class="s">&#39;type&#39;</span> <span class="p">:</span> <span class="s">&#39;normal&#39;</span><span class="p">,</span> <span class="s">&#39;stdev&#39;</span> <span class="p">:</span> <span class="mf">10.</span><span class="p">,</span> <span class="s">&#39;mean&#39;</span> <span class="p">:</span> <span class="mf">90.</span><span class="p">,</span> <span class="s">&#39;initial&#39;</span> <span class="p">:</span> <span class="mf">90.</span><span class="p">})</span>
<span class="n">param_stats</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;event&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;parameter&#39;</span> <span class="p">:</span> <span class="s">&#39;Slip&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span> <span class="p">:</span> <span class="mf">900.</span><span class="p">,</span> <span class="s">&#39;max&#39;</span> <span class="p">:</span> <span class="mf">1100.</span><span class="p">,</span>
                    <span class="s">&#39;type&#39;</span> <span class="p">:</span> <span class="s">&#39;normal&#39;</span><span class="p">,</span> <span class="s">&#39;stdev&#39;</span> <span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s">&#39;mean&#39;</span> <span class="p">:</span> <span class="mf">1000.</span><span class="p">,</span> <span class="s">&#39;initial&#39;</span> <span class="p">:</span> <span class="mf">1000.</span><span class="p">})</span>
<span class="c"># for event 3:</span>
<span class="n">param_stats</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;event&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;parameter&#39;</span> <span class="p">:</span> <span class="s">&#39;Dip&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span> <span class="p">:</span> <span class="mf">55.</span><span class="p">,</span> <span class="s">&#39;max&#39;</span> <span class="p">:</span> <span class="mf">65.</span><span class="p">,</span>
                    <span class="s">&#39;type&#39;</span> <span class="p">:</span> <span class="s">&#39;normal&#39;</span><span class="p">,</span> <span class="s">&#39;stdev&#39;</span> <span class="p">:</span> <span class="mf">10.</span><span class="p">,</span> <span class="s">&#39;mean&#39;</span> <span class="p">:</span> <span class="mf">60.</span><span class="p">,</span> <span class="s">&#39;initial&#39;</span> <span class="p">:</span> <span class="mf">60.</span><span class="p">})</span>
<span class="n">param_stats</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;event&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;parameter&#39;</span> <span class="p">:</span> <span class="s">&#39;Dip Direction&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span> <span class="p">:</span> <span class="mf">265.</span><span class="p">,</span> <span class="s">&#39;max&#39;</span> <span class="p">:</span> <span class="mf">275.</span><span class="p">,</span>
                    <span class="s">&#39;type&#39;</span> <span class="p">:</span> <span class="s">&#39;normal&#39;</span><span class="p">,</span> <span class="s">&#39;stdev&#39;</span> <span class="p">:</span> <span class="mf">10.</span><span class="p">,</span> <span class="s">&#39;mean&#39;</span> <span class="p">:</span> <span class="mf">270.</span><span class="p">,</span> <span class="s">&#39;initial&#39;</span> <span class="p">:</span> <span class="mf">270.</span><span class="p">})</span>
<span class="n">param_stats</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;event&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;parameter&#39;</span> <span class="p">:</span> <span class="s">&#39;Slip&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span> <span class="p">:</span> <span class="mf">900.</span><span class="p">,</span> <span class="s">&#39;max&#39;</span> <span class="p">:</span> <span class="mf">1100.</span><span class="p">,</span>
                    <span class="s">&#39;type&#39;</span> <span class="p">:</span> <span class="s">&#39;normal&#39;</span><span class="p">,</span> <span class="s">&#39;stdev&#39;</span> <span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s">&#39;mean&#39;</span> <span class="p">:</span> <span class="mf">1000.</span><span class="p">,</span> <span class="s">&#39;initial&#39;</span> <span class="p">:</span> <span class="mf">1000.</span><span class="p">})</span>

<span class="n">sa</span><span class="o">.</span><span class="n">set_parameter_statistics</span><span class="p">(</span><span class="n">param_stats</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="define-sampling-lines">
<h2>Define sampling lines<a class="headerlink" href="#define-sampling-lines" title="Permalink to this headline">¶</a></h2>
<p>As before, we need to define points in the model (or lines) which we
want to evaluate the sensitivity for:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># sa.add_sampling_line(5000, 3500, label = &#39;centre&#39;)</span>
<span class="n">sa</span><span class="o">.</span><span class="n">add_sampling_line</span><span class="p">(</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">3500</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;left&#39;</span><span class="p">)</span>
<span class="c"># sa.add_sampling_line(7500, 3500, label = &#39;right&#39;)</span>
<span class="c"># sa.add_sampling_line(4000, 3500, label = &#39;compare&#39;)</span>
</pre></div>
</div>
<p>And, again, we &#8220;freeze&#8221; the base state for later comparison and distance
caluclations:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">sa</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-up-the-parameter-set">
<h2>Setting-up the parameter set<a class="headerlink" href="#setting-up-the-parameter-set" title="Permalink to this headline">¶</a></h2>
<p>For use with SALib, we have to define a parameter set as a text file
(maybe there is a different way directly in Python - something to figure
out for the future). The sensitivity object has a method to do that
automatically:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">param_file</span> <span class="o">=</span> <span class="s">&quot;params_file_tmp.txt&quot;</span>
<span class="n">sa</span><span class="o">.</span><span class="n">create_params_file</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="n">param_file</span><span class="p">)</span>
</pre></div>
</div>
<p>We now invoke the methods of the SALib library to generate parameter
data sets that are required for the type of sensitivity analysis that we
want to perform:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># import SALib method</span>
<span class="kn">from</span> <span class="nn">SALib.sample</span> <span class="kn">import</span> <span class="n">saltelli</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">param_values</span> <span class="o">=</span> <span class="n">saltelli</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">param_file</span><span class="p">,</span> <span class="n">calc_second_order</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

&lt;ipython-input-19-b4266f3f8fc6&gt; in &lt;module&gt;()
----&gt; 1 param_values = saltelli.sample(10, param_file, calc_second_order = True)


/usr/local/Cellar/python/2.7.9/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/SALib-0.4-py2.7.egg/SALib/sample/saltelli.py in sample(problem, N, calc_second_order)
     12 def sample(problem, N, calc_second_order=True):
     13
---&gt; 14     D = problem[&#39;num_vars&#39;]
     15
     16     # How many values of the Sobol sequence to skip


TypeError: &#39;int&#39; object has no attribute &#39;__getitem__&#39;
</pre></div>
</div>
<p>The object &#8216;param_values&#8217; is a list of samples for the parameters that
are defined in the model, in the order of appearance in param_file,
e.g.:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">param_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="calculating-distances-for-all-parameter-sets">
<h2>Calculating distances for all parameter sets<a class="headerlink" href="#calculating-distances-for-all-parameter-sets" title="Permalink to this headline">¶</a></h2>
<p>We now need to create a model realisation for each of these parameter
sets and calculate the distance between the realisation and the base
model at the position of the defined sampling lines. As we are not
(always) interested in keeping the results of all realisations, those
steps are combined and only the calculated distance is retained (per
default):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">distances</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">determine_distances</span><span class="p">(</span><span class="n">param_values</span> <span class="o">=</span> <span class="n">param_values</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># plot(sa.get_model_lines(model_type = &#39;base&#39;))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">get_model_lines</span><span class="p">(</span><span class="n">model_type</span> <span class="o">=</span> <span class="s">&#39;current&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Just to check if we actualy did get different models:</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="s">&#39;.-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;Model distances&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Sensitivity step&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Distance&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="sensitivity-analysis">
<h2>Sensitivity analysis<a class="headerlink" href="#sensitivity-analysis" title="Permalink to this headline">¶</a></h2>
<p>We can now analyse the sensitivity of the modelled stratigraphy along
the defined vertical lines (&#8220;drillholes&#8221;) with respect to the model
parameters:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># save results</span>
<span class="n">results_file</span> <span class="o">=</span> <span class="s">&#39;dist_tmp.txt&#39;</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">results_file</span><span class="p">,</span> <span class="n">distances</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39; &#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">SALib.analyze</span> <span class="kn">import</span> <span class="n">sobol</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">Si</span> <span class="o">=</span> <span class="n">sobol</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">param_file</span><span class="p">,</span> <span class="n">results_file</span><span class="p">,</span>
                   <span class="n">column</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                   <span class="n">conf_level</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
                   <span class="n">calc_second_order</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
                   <span class="n">print_to_console</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># create composite matrix for sensitivities</span>
<span class="n">n_params</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">comp_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_params</span><span class="p">,</span><span class="n">n_params</span><span class="p">))</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_params</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_params</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
            <span class="n">comp_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Si</span><span class="p">[</span><span class="s">&#39;S1&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">comp_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Si</span><span class="p">[</span><span class="s">&#39;S2&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
            <span class="n">comp_matrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Si</span><span class="p">[</span><span class="s">&#39;S2&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>

<span class="c"># print comp_matrix</span>

<span class="c"># define labels for figure: phi = dip, d = dip direction, s = slip, subscript = fault event</span>
<span class="n">label_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;$\phi_1$&quot;</span><span class="p">,</span> <span class="s">&quot;$d_1$&quot;</span><span class="p">,</span> <span class="s">&quot;$s_1$&quot;</span><span class="p">,</span> <span class="s">&quot;$\phi_2$&quot;</span><span class="p">,</span> <span class="s">&quot;$d_2$&quot;</span><span class="p">,</span> <span class="s">&quot;$s_2$&quot;</span><span class="p">]</span>

<span class="c"># Create figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">comp_matrix</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">&#39;RdBu_r&#39;</span><span class="p">,</span>
               <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">comp_matrix</span><span class="p">)),</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">comp_matrix</span><span class="p">)),</span>

<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s">&quot;both&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s">&quot;top&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">label_names</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">label_names</span><span class="p">)</span>

<span class="c"># ax.set_title(&quot;Sensitivities&quot;)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&quot;Parameter Sensitivities&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c"># plt.savefig(&quot;two_fault_sensi.png&quot;)</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-parameter-ranges-from-file">
<h2>Reading parameter ranges from file<a class="headerlink" href="#reading-parameter-ranges-from-file" title="Permalink to this headline">¶</a></h2>
<p>So, now that we have all the required ingredients for the sensitivity
analysis, we can make life a bit easier with more automation. First,
instead of defining parameters in a dictionary as above, we can actually
read them in from a csv file (e.g. saved from Excel as Windows-csv
file).</p>
<p>In order to be read in correctly, the header should contain the labels:</p>
<ul class="simple">
<li>&#8216;event&#8217; : event id</li>
<li>&#8216;parameter&#8217; : Noddy parameter (&#8216;Dip&#8217;, &#8216;Dip Direction&#8217;, etc.)</li>
<li>&#8216;min&#8217; : minimum value</li>
<li>&#8216;max&#8217; : maximum value</li>
<li>&#8216;initial&#8217; : initial value</li>
</ul>
<p>In addition, it is possible to define PDF type and parameters. For now,
the following settings are supported:</p>
<ul class="simple">
<li>&#8216;type&#8217; = &#8216;normal&#8217;</li>
<li>&#8216;stdev&#8217; : standard deviation</li>
<li>&#8216;mean&#8217; : mean value (default: &#8216;initial&#8217; value)</li>
</ul>
<p>We can read in the parameters simply with:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">reload</span><span class="p">(</span><span class="n">pynoddy</span><span class="o">.</span><span class="n">history</span><span class="p">)</span>
<span class="nb">reload</span><span class="p">(</span><span class="n">pynoddy</span><span class="o">.</span><span class="n">experiment</span><span class="p">)</span>
<span class="c"># Start again with the original model</span>
<span class="n">his_filename</span> <span class="o">=</span> <span class="s">&quot;two_faults_sensi.his&quot;</span>
<span class="n">sa</span> <span class="o">=</span> <span class="n">pynoddy</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">SensitivityAnalysis</span><span class="p">(</span><span class="n">history</span> <span class="o">=</span> <span class="n">his_filename</span><span class="p">)</span>
<span class="n">sa</span><span class="o">.</span><span class="n">load_parameter_file</span><span class="p">(</span><span class="s">&quot;params_fault_model.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The only further aspect we need to define are the sampling lines:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># sa.add_sampling_line(5000, 3500, label = &#39;centre&#39;)</span>
<span class="n">sa</span><span class="o">.</span><span class="n">add_sampling_line</span><span class="p">(</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">3500</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;left&#39;</span><span class="p">)</span>
<span class="c"># sa.add_sampling_line(7500, 3500, label = &#39;right&#39;)</span>
<span class="c"># sa.add_sampling_line(4000, 3500, label = &#39;compare&#39;)</span>
</pre></div>
</div>
<p>And then we know everything to perform the sensitivity analysis. The
relevant steps are combined in one method:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">sa</span><span class="o">.</span><span class="n">perform_analsis</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">sa</span><span class="o">.</span><span class="n">plot_distances</span><span class="p">()</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">sa</span><span class="o">.</span><span class="n">plot_sensitivity_matrix</span><span class="p">()</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># for event 2:</span>
<span class="n">param_stats</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;event&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;parameter&#39;</span> <span class="p">:</span> <span class="s">&#39;Dip&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span> <span class="p">:</span> <span class="mf">55.</span><span class="p">,</span> <span class="s">&#39;max&#39;</span> <span class="p">:</span> <span class="mf">65.</span><span class="p">,</span>
                    <span class="s">&#39;type&#39;</span> <span class="p">:</span> <span class="s">&#39;normal&#39;</span><span class="p">,</span> <span class="s">&#39;stdev&#39;</span> <span class="p">:</span> <span class="mf">10.</span><span class="p">,</span> <span class="s">&#39;mean&#39;</span> <span class="p">:</span> <span class="mf">60.</span><span class="p">,</span> <span class="s">&#39;initial&#39;</span> <span class="p">:</span> <span class="mf">60.</span><span class="p">})</span>
<span class="n">param_stats</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;event&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;parameter&#39;</span> <span class="p">:</span> <span class="s">&#39;Dip Direction&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span> <span class="p">:</span> <span class="mf">85.</span><span class="p">,</span> <span class="s">&#39;max&#39;</span> <span class="p">:</span> <span class="mf">95.</span><span class="p">,</span>
                    <span class="s">&#39;type&#39;</span> <span class="p">:</span> <span class="s">&#39;normal&#39;</span><span class="p">,</span> <span class="s">&#39;stdev&#39;</span> <span class="p">:</span> <span class="mf">10.</span><span class="p">,</span> <span class="s">&#39;mean&#39;</span> <span class="p">:</span> <span class="mf">90.</span><span class="p">,</span> <span class="s">&#39;initial&#39;</span> <span class="p">:</span> <span class="mf">90.</span><span class="p">})</span>
<span class="n">param_stats</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;event&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;parameter&#39;</span> <span class="p">:</span> <span class="s">&#39;Slip&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span> <span class="p">:</span> <span class="mf">900.</span><span class="p">,</span> <span class="s">&#39;max&#39;</span> <span class="p">:</span> <span class="mf">1100.</span><span class="p">,</span>
                    <span class="s">&#39;type&#39;</span> <span class="p">:</span> <span class="s">&#39;normal&#39;</span><span class="p">,</span> <span class="s">&#39;stdev&#39;</span> <span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s">&#39;mean&#39;</span> <span class="p">:</span> <span class="mf">1000.</span><span class="p">,</span> <span class="s">&#39;initial&#39;</span> <span class="p">:</span> <span class="mf">1000.</span><span class="p">})</span>
<span class="c"># for event 3:</span>
<span class="n">param_stats</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;event&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;parameter&#39;</span> <span class="p">:</span> <span class="s">&#39;Dip&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span> <span class="p">:</span> <span class="mf">55.</span><span class="p">,</span> <span class="s">&#39;max&#39;</span> <span class="p">:</span> <span class="mf">65.</span><span class="p">,</span>
                    <span class="s">&#39;type&#39;</span> <span class="p">:</span> <span class="s">&#39;normal&#39;</span><span class="p">,</span> <span class="s">&#39;stdev&#39;</span> <span class="p">:</span> <span class="mf">10.</span><span class="p">,</span> <span class="s">&#39;mean&#39;</span> <span class="p">:</span> <span class="mf">60.</span><span class="p">,</span> <span class="s">&#39;initial&#39;</span> <span class="p">:</span> <span class="mf">60.</span><span class="p">})</span>
<span class="n">param_stats</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;event&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;parameter&#39;</span> <span class="p">:</span> <span class="s">&#39;Dip Direction&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span> <span class="p">:</span> <span class="mf">265.</span><span class="p">,</span> <span class="s">&#39;max&#39;</span> <span class="p">:</span> <span class="mf">275.</span><span class="p">,</span>
                    <span class="s">&#39;type&#39;</span> <span class="p">:</span> <span class="s">&#39;normal&#39;</span><span class="p">,</span> <span class="s">&#39;stdev&#39;</span> <span class="p">:</span> <span class="mf">10.</span><span class="p">,</span> <span class="s">&#39;mean&#39;</span> <span class="p">:</span> <span class="mf">270.</span><span class="p">,</span> <span class="s">&#39;initial&#39;</span> <span class="p">:</span> <span class="mf">270.</span><span class="p">})</span>
<span class="n">param_stats</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;event&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;parameter&#39;</span> <span class="p">:</span> <span class="s">&#39;Slip&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span> <span class="p">:</span> <span class="mf">900.</span><span class="p">,</span> <span class="s">&#39;max&#39;</span> <span class="p">:</span> <span class="mf">1100.</span><span class="p">,</span>
                    <span class="s">&#39;type&#39;</span> <span class="p">:</span> <span class="s">&#39;normal&#39;</span><span class="p">,</span> <span class="s">&#39;stdev&#39;</span> <span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s">&#39;mean&#39;</span> <span class="p">:</span> <span class="mf">1000.</span><span class="p">,</span> <span class="s">&#39;initial&#39;</span> <span class="p">:</span> <span class="mf">1000.</span><span class="p">})</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">sa</span><span class="o">.</span><span class="n">param_stats</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">sa</span><span class="o">.</span><span class="n">plot_section</span><span class="p">(</span><span class="n">model_type</span> <span class="o">=</span> <span class="s">&quot;base&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">get_drillhole_data</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">3500</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">get_model_lines</span><span class="p">())</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">reload</span><span class="p">(</span><span class="n">pynoddy</span><span class="o">.</span><span class="n">history</span><span class="p">)</span>
<span class="nb">reload</span><span class="p">(</span><span class="n">pynoddy</span><span class="o">.</span><span class="n">experiment</span><span class="p">)</span>
<span class="n">sa2</span> <span class="o">=</span> <span class="n">pynoddy</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span><span class="n">history</span> <span class="o">=</span> <span class="s">&quot;two_faults_sensi.his&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">sa2</span><span class="o">.</span><span class="n">write_history</span><span class="p">(</span><span class="s">&quot;test5.his&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">nm</span> <span class="o">=</span> <span class="n">pynoddy</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">NoddyHistory</span><span class="p">(</span><span class="n">history</span> <span class="o">=</span> <span class="s">&quot;two_faults_sensi.his&quot;</span><span class="p">)</span>
<span class="c"># nm.determine_events()</span>
<span class="n">nm</span><span class="o">.</span><span class="n">write_history</span><span class="p">(</span><span class="s">&quot;test6.his&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">param_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">reload</span><span class="p">(</span><span class="n">pynoddy</span><span class="o">.</span><span class="n">history</span><span class="p">)</span>
<span class="nb">reload</span><span class="p">(</span><span class="n">pynoddy</span><span class="o">.</span><span class="n">experiment</span><span class="p">)</span>
<span class="c"># Start again with the original model</span>
<span class="n">his_filename</span> <span class="o">=</span> <span class="s">&quot;two_faults_sensi.his&quot;</span>
<span class="n">sa</span> <span class="o">=</span> <span class="n">pynoddy</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">SensitivityAnalysis</span><span class="p">(</span><span class="n">history</span> <span class="o">=</span> <span class="n">his_filename</span><span class="p">)</span>

<span class="n">sa</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
<span class="c"># sa.change_event_params({3 : {&#39;Slip&#39; : 500.}})</span>
<span class="n">sa</span><span class="o">.</span><span class="n">change_event_params</span><span class="p">({</span><span class="mi">3</span> <span class="p">:</span> <span class="p">{</span><span class="s">&#39;Dip&#39;</span> <span class="p">:</span> <span class="mf">15.</span><span class="p">}})</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

&lt;ipython-input-22-3455686c98cb&gt; in &lt;module&gt;()
      3 # Start again with the original model
      4 his_filename = &quot;two_faults_sensi.his&quot;
----&gt; 5 sa = pynoddy.experiment.SensitivityAnalysis(history = his_filename)
      6
      7 sa.freeze()


TypeError: &#39;module&#39; object is not callable
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">sa</span><span class="o">.</span><span class="n">plot_section</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="n">sa</span><span class="o">.</span><span class="n">plot_section</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">model_type</span> <span class="o">=</span> <span class="s">&quot;base&quot;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/9-Sensitivity-Analysis_43_0.png" src="_images/9-Sensitivity-Analysis_43_0.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">sa</span><span class="o">.</span><span class="n">change_event_params</span><span class="p">({</span><span class="mi">3</span> <span class="p">:</span> <span class="p">{</span><span class="s">&#39;Slip&#39;</span> <span class="p">:</span> <span class="mf">100.</span><span class="p">}})</span>
<span class="n">sa</span><span class="o">.</span><span class="n">plot_section</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/9-Sensitivity-Analysis_44_0.png" src="_images/9-Sensitivity-Analysis_44_0.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># sa.add_sampling_line(5000, 3500, label = &#39;centre&#39;)</span>
<span class="c"># sa.add_sampling_line(2500, 3500, label = &#39;left&#39;)</span>
<span class="n">sa</span><span class="o">.</span><span class="n">add_sampling_line</span><span class="p">(</span><span class="mi">7500</span><span class="p">,</span> <span class="mi">3500</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;right&#39;</span><span class="p">)</span>
<span class="c"># sa.add_sampling_line(4000, 3500, label = &#39;compare&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">get_model_lines</span><span class="p">(),</span> <span class="s">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">get_model_lines</span><span class="p">(</span><span class="n">model_type</span> <span class="o">=</span> <span class="s">&quot;base&quot;</span><span class="p">),</span> <span class="s">&#39;b&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>[&lt;matplotlib.lines.Line2D at 0x113c09a90&gt;]
</pre></div>
</div>
<img alt="_images/9-Sensitivity-Analysis_45_1.png" src="_images/9-Sensitivity-Analysis_45_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">pwd</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Sensitivity analysis with SALib</a><ul>
<li><a class="reference internal" href="#model-set-up">Model set-up</a></li>
<li><a class="reference internal" href="#define-sampling-lines">Define sampling lines</a></li>
<li><a class="reference internal" href="#setting-up-the-parameter-set">Setting-up the parameter set</a></li>
<li><a class="reference internal" href="#calculating-distances-for-all-parameter-sets">Calculating distances for all parameter sets</a></li>
<li><a class="reference internal" href="#sensitivity-analysis">Sensitivity analysis</a></li>
<li><a class="reference internal" href="#reading-parameter-ranges-from-file">Reading parameter ranges from file</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/9-Sensitivity-Analysis.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pynoddy  documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Florian Wellmann.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>